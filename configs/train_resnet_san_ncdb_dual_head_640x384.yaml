# ST2 Dual-Head Training Configuration - NCDB 640x384
# Purpose: Complete ST2 Dual-Head training on NCDB dataset
# Resolution: 640x384
# Depth Range: 0.5m - 15.0m (near-field)
# Based on: docs/quantization/ST2/Quick_Reference.md

model:
    name: 'SemiSupCompletionModel'
    
    # Loss configuration
    loss:
        supervised_method: 'sparse-ssi-silog'
        supervised_num_scales: 1
        supervised_loss_weight: 1.0
    
    # Optimizer configuration
    optimizer:
        name: 'Adam'
        depth:
            lr: 0.0002              # ⭐ Dual-Head recommended learning rate (2e-4)
        pose:
            lr: 0.0001
    
    # Scheduler configuration
    scheduler:
        name: 'StepLR'
        step_size: 15
        gamma: 0.5
    
    # Depth Network configuration
    depth_net:
        name: 'ResNetSAN01'
        version: '18A'
        use_dual_head: true           # ⭐ Enable Dual-Head architecture
        use_film: false               # Disable FiLM for pure depth prediction test
        use_enhanced_lidar: false     # Disable Enhanced LiDAR for simplicity
    
    # Depth range configuration (NCDB: near-field)
    params:
        crop: ''
        min_depth: 0.5                # ⭐ NCDB near-field minimum
        max_depth: 15.0               # ⭐ NCDB near-field maximum
        scale_output: 'top-center'
        use_log_space: false

# Dataset configuration (NCDB)
datasets:
    augmentation:
        image_shape: [384, 640]
    train:
        batch_size: 4
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_train.json']
        mask_file: ['binary_mask.png']
        use_mask: [false]
    validation:
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_val.json']
        mask_file: ['binary_mask.png']
        use_mask: [false]
    test:
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_test.json']
        mask_file: ['binary_mask.png']
        use_mask: [false]

# Architecture settings
arch:
    seed: 42
    clip_grad: 1.0
    max_epochs: 30                    # ⭐ Full training: 30 epochs
    eval_during_training: true
    eval_progress_interval: 0.25
    eval_subset_size: 50

# Checkpoint configuration
checkpoint:
    filepath: 'checkpoints/resnetsan01_dual_head_ncdb_640x384/'
    save_top_k: 3                     # Save top 3 checkpoints

# Save configuration
save:
    folder: 'outputs/resnetsan01_dual_head_ncdb_640x384/'

# Tensorboard logging
tensorboard:
    dry_run: false
    log_frequency: 10
