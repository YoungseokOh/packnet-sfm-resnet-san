# ST2 Dual-Head Training Configuration - NCDB 640x384
# Purpose: Complete ST2 Dual-Head training on NCDB dataset
# Resolution: 640x384
# Depth Range: 0.1m - 15.0m (near-field)
# Based on: docs/quantization/ST2/Quick_Reference.md

model:
    name: 'SemiSupCompletionModel'
    
    # Loss configuration
    loss:
        supervised_method: 'sparse-ssi-silog'
        supervised_num_scales: 1
        supervised_loss_weight: 1.0
        # ğŸ†• SSI-Silog Loss íŒŒë¼ë¯¸í„° (ê· í˜• ì¡íŒ ì¶”ì²œ ì„¤ì •)
        ssi_weight: 0.5               # SSI (ìƒëŒ€ì  ì •í™•ë„) ê°€ì¤‘ì¹˜
        silog_weight: 0.5             # Silog (ì ˆëŒ€ì  ì •í™•ë„) ê°€ì¤‘ì¹˜
        alpha: 0.85                   # SSI mean penalty (bias ì œê±°)
        silog_ratio2: 0.85            # Silog scale-invariance ê³„ìˆ˜
    
    # Optimizer configuration
    optimizer:
        name: 'Adam'
        depth:
            lr: 0.0002              # â­ Dual-Head recommended learning rate (2e-4)
        pose:
            lr: 0.0001
    
    # Scheduler configuration
    scheduler:
        name: 'StepLR'
        step_size: 30
        gamma: 0.5
    
    # Depth Network configuration
    depth_net:
        name: 'ResNetSAN01'
        version: '18A'
        use_dual_head: true           # â­ Enable Dual-Head architecture
        use_film: True               # Disable FiLM for pure depth prediction test
        use_enhanced_lidar: false     # Disable Enhanced LiDAR for simplicity
    
    # Depth range configuration (NCDB: near-field)
    params:
        crop: ''
        min_depth: 0.1                # â­ NCDB near-field minimum
        max_depth: 15.0               # â­ NCDB near-field maximum
        scale_output: 'top-center'
        use_log_space: false

# Dataset configuration (NCDB)
datasets:
    augmentation:
        image_shape: [384, 640]
    train:
        batch_size: 12
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_train.json']
        depth_type: ['distance']      # â­ 'distance' (3D euclidean) - for this config
        mask_file: ['binary_mask.png']
        use_mask: [false]
    validation:
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_val.json']
        depth_type: ['distance']      # â­ 'distance' (3D euclidean)
        mask_file: ['binary_mask.png']
        use_mask: [false]
    test:
        dataset: ['ncdb']
        path: ['/workspace/data/ncdb-cls-640x384']
        split: ['splits/combined_test.json']
        depth_type: ['distance']      # â­ 'distance' (3D euclidean)
        mask_file: ['binary_mask.png']
        use_mask: [false]

# Architecture settings
arch:
    seed: 42
    clip_grad: 1.0
    max_epochs: 50                    # â­ Full training: 50 epochs
    eval_during_training: true
    eval_progress_interval: 0.5
    eval_subset_size: 100

# Checkpoint configuration

############################################
# UF means 'Use Film'
# Original means 'original depth maps' from NCDB
# 0.1 to 15m depth range
# resnetsan means ResNetSAN01 architecture
############################################

checkpoint:
    filepath: 'checkpoints/resnetsan_distance_ncdb_640x384_01_to_15m_SSI_Silog_05_05/'
    save_top_k: -1                    # Save all checkpoints (team policy)
    period: 1                         # Save every 2 epochs (disk optimization)

# Save configuration
save:
    folder: 'outputs/resnetsan_distance_ncdb_640x384_01_to_15m_SSI_Silog_05_05/'

# Tensorboard logging
tensorboard:
    dry_run: false
    log_frequency: 100
